# Калькулятор на C# с ограничениями

Простой консольный калькулятор (+, -, *, /), который валидирует ввод и чётко сообщает об ошибках. Поддерживает интерактивный режим и запуск с выражением в аргументах.

Файл с кодом: `1.1.cs`

## Ограничения (минимум 4)
- Только операции: `+`, `-`, `*`, `/`.
- Ровно два операнда: выражение вида `<число> <операция> <число>` (пример: `12.5 * 3`) или `12.5*3`.
- Диапазон операндов: `|операнд| ≤ 1 000 000`.
- Ограничение результата: `|результат| ≤ 1 000 000 000`.
- Десятичный разделитель — только точка `.`; до 4 знаков после точки.
- Длина выражения — не более 100 символов.
- Деление на ноль запрещено.

Все ограничения проверяются и сопровождаются понятными сообщениями об ошибках.

## Примеры
```bash
# Интерактивный режим
dotnet run

# Одноразовый запуск с выражением
dotnet run -- "12.5 * 3"
dotnet run -- "1000001 + 0"       # Ошибка: операнд вне диапазона
dotnet run -- "10 / 0"             # Ошибка: деление на ноль
dotnet run -- "2,5 + 1"            # Ошибка: используйте точку как разделитель
dotnet run -- "3.14159 + 1"        # Ошибка: не более 4 знаков после точки
```

## Как запустить
Требуется установленный .NET SDK (рекомендуется .NET 8/9).

### macOS / Linux
1. Откройте папку проекта в терминале.
2. Соберите проект: `dotnet build`
3. Запустите интерактивно: `dotnet run`
   - или передайте выражение: `dotnet run -- "12.5 * 3"`

### Windows
1. Установите .NET SDK с [официального сайта](https://dotnet.microsoft.com/download).
2. Откройте PowerShell или командную строку (`Win` → «PowerShell»/`cmd`).
3. Перейдите в папку проекта: `cd "C:\путь\к\PR_KP_1.1"`
4. Соберите проект: `dotnet build`
5. Запустите интерактивно: `dotnet run`
   - или передайте выражение: `dotnet run -- "12.5 * 3"`

Советы:
- Десятичный разделитель — точка `.` (локаль не влияет, применяется `InvariantCulture`).
- В интерактивном режиме команды `exit`/пустая строка — выход.

## Что делает калькулятор внутри
- Парсит выражение регулярным выражением с одним оператором и двумя операндами.
- Использует тип `decimal` для избегания ошибок двоичной арифметики (`double`).
- Проверяет: формат, число знаков после точки, диапазоны операндов/результата, деление на ноль.
- Округляет результат до 4 знаков по правилу `MidpointRounding.ToEven` (только для отображения).

## Типичные ошибки разработчика и как они решены
1. Деление на ноль обрабатывается исключением `DivideByZeroException` и сообщением, а не падением программы.
2. Потеря точности при использовании `double` — применяется `decimal` и культура `InvariantCulture`.
3. Отсутствие проверки диапазонов — введены лимиты для операндов и результата, с понятными ошибками.
4. Неоднозначный парсинг из-за локали — запрещена запятая, строго используется точка `.`.
5. Парсинг «всего подряд» — регулярное выражение разрешает только один оператор и два операнда.
6. Тихое переполнение — используется `checked` и ловится `OverflowException`.
7. Плохие сообщения об ошибках — все ошибки консистентно формулируются (что не так и как исправить).

## Структура
- `..csproj` — файл проекта (создан шаблоном `dotnet new`).
- `1.1.cs` — исходный код калькулятора (точка входа `Main`).

## Примечания
- Если хотите разрешить запятую, нужно снять ограничение валидации и учесть смену `CultureInfo`.
- Для более сложной математики (скобки, функции) потребуется полноценный парсер выражений.
